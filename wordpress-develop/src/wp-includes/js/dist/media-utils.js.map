{"version":3,"file":"media-utils.js","mappings":"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","sources":["webpack://wp/./node_modules/@wordpress/media-utils/build-module/components/@wordpress/media-utils/src/components/index.js","webpack://wp/./node_modules/@wordpress/media-utils/build-module/components/media-upload/@wordpress/media-utils/src/components/media-upload/index.js","webpack://wp/./node_modules/@wordpress/media-utils/build-module/utils/@wordpress/media-utils/src/utils/flatten-form-data.ts","webpack://wp/./node_modules/@wordpress/media-utils/build-module/utils/@wordpress/media-utils/src/utils/get-mime-types-array.ts","webpack://wp/./node_modules/@wordpress/media-utils/build-module/utils/@wordpress/media-utils/src/utils/transform-attachment.ts","webpack://wp/./node_modules/@wordpress/media-utils/build-module/utils/@wordpress/media-utils/src/utils/upload-error.ts","webpack://wp/./node_modules/@wordpress/media-utils/build-module/utils/@wordpress/media-utils/src/utils/upload-media.ts","webpack://wp/./node_modules/@wordpress/media-utils/build-module/utils/@wordpress/media-utils/src/utils/upload-to-server.ts","webpack://wp/./node_modules/@wordpress/media-utils/build-module/utils/@wordpress/media-utils/src/utils/validate-file-size.ts","webpack://wp/./node_modules/@wordpress/media-utils/build-module/utils/@wordpress/media-utils/src/utils/validate-mime-type-for-user.ts","webpack://wp/./node_modules/@wordpress/media-utils/build-module/utils/@wordpress/media-utils/src/utils/validate-mime-type.ts","webpack://wp/external window [\"wp\",\"apiFetch\"]","webpack://wp/external window [\"wp\",\"blob\"]","webpack://wp/external window [\"wp\",\"element\"]","webpack://wp/external window [\"wp\",\"i18n\"]","webpack://wp/webpack/bootstrap","webpack://wp/webpack/runtime/compat get default export","webpack://wp/webpack/runtime/define property getters","webpack://wp/webpack/runtime/hasOwnProperty shorthand","webpack://wp/webpack/runtime/make namespace object","webpack://wp/./node_modules/@wordpress/media-utils/build-module/@wordpress/media-utils/src/index.ts"],"sourcesContent":["export { default as MediaUpload } from './media-upload';\n","/**\n * WordPress dependencies\n */\nimport { Component } from '@wordpress/element';\nimport { __ } from '@wordpress/i18n';\n\nconst DEFAULT_EMPTY_GALLERY = [];\n\n/**\n * Prepares the Featured Image toolbars and frames.\n *\n * @return {window.wp.media.view.MediaFrame.Select} The default media workflow.\n */\nconst getFeaturedImageMediaFrame = () => {\n\tconst { wp } = window;\n\n\treturn wp.media.view.MediaFrame.Select.extend( {\n\t\t/**\n\t\t * Enables the Set Featured Image Button.\n\t\t *\n\t\t * @param {Object} toolbar toolbar for featured image state\n\t\t * @return {void}\n\t\t */\n\t\tfeaturedImageToolbar( toolbar ) {\n\t\t\tthis.createSelectToolbar( toolbar, {\n\t\t\t\ttext: wp.media.view.l10n.setFeaturedImage,\n\t\t\t\tstate: this.options.state,\n\t\t\t} );\n\t\t},\n\n\t\t/**\n\t\t * Handle the edit state requirements of selected media item.\n\t\t *\n\t\t * @return {void}\n\t\t */\n\t\teditState() {\n\t\t\tconst selection = this.state( 'featured-image' ).get( 'selection' );\n\t\t\tconst view = new wp.media.view.EditImage( {\n\t\t\t\tmodel: selection.single(),\n\t\t\t\tcontroller: this,\n\t\t\t} ).render();\n\n\t\t\t// Set the view to the EditImage frame using the selected image.\n\t\t\tthis.content.set( view );\n\n\t\t\t// After bringing in the frame, load the actual editor via an ajax call.\n\t\t\tview.loadEditor();\n\t\t},\n\n\t\t/**\n\t\t * Create the default states.\n\t\t *\n\t\t * @return {void}\n\t\t */\n\t\tcreateStates: function createStates() {\n\t\t\tthis.on(\n\t\t\t\t'toolbar:create:featured-image',\n\t\t\t\tthis.featuredImageToolbar,\n\t\t\t\tthis\n\t\t\t);\n\t\t\tthis.on( 'content:render:edit-image', this.editState, this );\n\n\t\t\tthis.states.add( [\n\t\t\t\tnew wp.media.controller.FeaturedImage(),\n\t\t\t\tnew wp.media.controller.EditImage( {\n\t\t\t\t\tmodel: this.options.editImage,\n\t\t\t\t} ),\n\t\t\t] );\n\t\t},\n\t} );\n};\n\n/**\n * Prepares the Gallery toolbars and frames.\n *\n * @return {window.wp.media.view.MediaFrame.Post} The default media workflow.\n */\nconst getGalleryDetailsMediaFrame = () => {\n\tconst { wp } = window;\n\t/**\n\t * Custom gallery details frame.\n\t *\n\t * @see https://github.com/xwp/wp-core-media-widgets/blob/905edbccfc2a623b73a93dac803c5335519d7837/wp-admin/js/widgets/media-gallery-widget.js\n\t * @class GalleryDetailsMediaFrame\n\t * @class\n\t */\n\treturn wp.media.view.MediaFrame.Post.extend( {\n\t\t/**\n\t\t * Set up gallery toolbar.\n\t\t *\n\t\t * @return {void}\n\t\t */\n\t\tgalleryToolbar() {\n\t\t\tconst editing = this.state().get( 'editing' );\n\t\t\tthis.toolbar.set(\n\t\t\t\tnew wp.media.view.Toolbar( {\n\t\t\t\t\tcontroller: this,\n\t\t\t\t\titems: {\n\t\t\t\t\t\tinsert: {\n\t\t\t\t\t\t\tstyle: 'primary',\n\t\t\t\t\t\t\ttext: editing\n\t\t\t\t\t\t\t\t? wp.media.view.l10n.updateGallery\n\t\t\t\t\t\t\t\t: wp.media.view.l10n.insertGallery,\n\t\t\t\t\t\t\tpriority: 80,\n\t\t\t\t\t\t\trequires: { library: true },\n\n\t\t\t\t\t\t\t/**\n\t\t\t\t\t\t\t * @fires wp.media.controller.State#update\n\t\t\t\t\t\t\t */\n\t\t\t\t\t\t\tclick() {\n\t\t\t\t\t\t\t\tconst controller = this.controller,\n\t\t\t\t\t\t\t\t\tstate = controller.state();\n\n\t\t\t\t\t\t\t\tcontroller.close();\n\t\t\t\t\t\t\t\tstate.trigger(\n\t\t\t\t\t\t\t\t\t'update',\n\t\t\t\t\t\t\t\t\tstate.get( 'library' )\n\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\t// Restore and reset the default state.\n\t\t\t\t\t\t\t\tcontroller.setState( controller.options.state );\n\t\t\t\t\t\t\t\tcontroller.reset();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t} )\n\t\t\t);\n\t\t},\n\n\t\t/**\n\t\t * Handle the edit state requirements of selected media item.\n\t\t *\n\t\t * @return {void}\n\t\t */\n\t\teditState() {\n\t\t\tconst selection = this.state( 'gallery' ).get( 'selection' );\n\t\t\tconst view = new wp.media.view.EditImage( {\n\t\t\t\tmodel: selection.single(),\n\t\t\t\tcontroller: this,\n\t\t\t} ).render();\n\n\t\t\t// Set the view to the EditImage frame using the selected image.\n\t\t\tthis.content.set( view );\n\n\t\t\t// After bringing in the frame, load the actual editor via an ajax call.\n\t\t\tview.loadEditor();\n\t\t},\n\n\t\t/**\n\t\t * Create the default states.\n\t\t *\n\t\t * @return {void}\n\t\t */\n\t\tcreateStates: function createStates() {\n\t\t\tthis.on( 'toolbar:create:main-gallery', this.galleryToolbar, this );\n\t\t\tthis.on( 'content:render:edit-image', this.editState, this );\n\n\t\t\tthis.states.add( [\n\t\t\t\tnew wp.media.controller.Library( {\n\t\t\t\t\tid: 'gallery',\n\t\t\t\t\ttitle: wp.media.view.l10n.createGalleryTitle,\n\t\t\t\t\tpriority: 40,\n\t\t\t\t\ttoolbar: 'main-gallery',\n\t\t\t\t\tfilterable: 'uploaded',\n\t\t\t\t\tmultiple: 'add',\n\t\t\t\t\teditable: false,\n\n\t\t\t\t\tlibrary: wp.media.query( {\n\t\t\t\t\t\ttype: 'image',\n\t\t\t\t\t\t...this.options.library,\n\t\t\t\t\t} ),\n\t\t\t\t} ),\n\t\t\t\tnew wp.media.controller.EditImage( {\n\t\t\t\t\tmodel: this.options.editImage,\n\t\t\t\t} ),\n\n\t\t\t\tnew wp.media.controller.GalleryEdit( {\n\t\t\t\t\tlibrary: this.options.selection,\n\t\t\t\t\tediting: this.options.editing,\n\t\t\t\t\tmenu: 'gallery',\n\t\t\t\t\tdisplaySettings: false,\n\t\t\t\t\tmultiple: true,\n\t\t\t\t} ),\n\n\t\t\t\tnew wp.media.controller.GalleryAdd(),\n\t\t\t] );\n\t\t},\n\t} );\n};\n\n// The media library image object contains numerous attributes\n// we only need this set to display the image in the library.\nconst slimImageObject = ( img ) => {\n\tconst attrSet = [\n\t\t'sizes',\n\t\t'mime',\n\t\t'type',\n\t\t'subtype',\n\t\t'id',\n\t\t'url',\n\t\t'alt',\n\t\t'link',\n\t\t'caption',\n\t];\n\treturn attrSet.reduce( ( result, key ) => {\n\t\tif ( img?.hasOwnProperty( key ) ) {\n\t\t\tresult[ key ] = img[ key ];\n\t\t}\n\t\treturn result;\n\t}, {} );\n};\n\nconst getAttachmentsCollection = ( ids ) => {\n\tconst { wp } = window;\n\n\treturn wp.media.query( {\n\t\torder: 'ASC',\n\t\torderby: 'post__in',\n\t\tpost__in: ids,\n\t\tposts_per_page: -1,\n\t\tquery: true,\n\t\ttype: 'image',\n\t} );\n};\n\nclass MediaUpload extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\t\tthis.openModal = this.openModal.bind( this );\n\t\tthis.onOpen = this.onOpen.bind( this );\n\t\tthis.onSelect = this.onSelect.bind( this );\n\t\tthis.onUpdate = this.onUpdate.bind( this );\n\t\tthis.onClose = this.onClose.bind( this );\n\t}\n\n\tinitializeListeners() {\n\t\t// When an image is selected in the media frame...\n\t\tthis.frame.on( 'select', this.onSelect );\n\t\tthis.frame.on( 'update', this.onUpdate );\n\t\tthis.frame.on( 'open', this.onOpen );\n\t\tthis.frame.on( 'close', this.onClose );\n\t}\n\n\t/**\n\t * Sets the Gallery frame and initializes listeners.\n\t *\n\t * @return {void}\n\t */\n\tbuildAndSetGalleryFrame() {\n\t\tconst {\n\t\t\taddToGallery = false,\n\t\t\tallowedTypes,\n\t\t\tmultiple = false,\n\t\t\tvalue = DEFAULT_EMPTY_GALLERY,\n\t\t} = this.props;\n\n\t\t// If the value did not changed there is no need to rebuild the frame,\n\t\t// we can continue to use the existing one.\n\t\tif ( value === this.lastGalleryValue ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { wp } = window;\n\n\t\tthis.lastGalleryValue = value;\n\n\t\t// If a frame already existed remove it.\n\t\tif ( this.frame ) {\n\t\t\tthis.frame.remove();\n\t\t}\n\t\tlet currentState;\n\t\tif ( addToGallery ) {\n\t\t\tcurrentState = 'gallery-library';\n\t\t} else {\n\t\t\tcurrentState = value && value.length ? 'gallery-edit' : 'gallery';\n\t\t}\n\t\tif ( ! this.GalleryDetailsMediaFrame ) {\n\t\t\tthis.GalleryDetailsMediaFrame = getGalleryDetailsMediaFrame();\n\t\t}\n\t\tconst attachments = getAttachmentsCollection( value );\n\t\tconst selection = new wp.media.model.Selection( attachments.models, {\n\t\t\tprops: attachments.props.toJSON(),\n\t\t\tmultiple,\n\t\t} );\n\t\tthis.frame = new this.GalleryDetailsMediaFrame( {\n\t\t\tmimeType: allowedTypes,\n\t\t\tstate: currentState,\n\t\t\tmultiple,\n\t\t\tselection,\n\t\t\tediting: value && value.length ? true : false,\n\t\t} );\n\t\twp.media.frame = this.frame;\n\t\tthis.initializeListeners();\n\t}\n\n\t/**\n\t * Initializes the Media Library requirements for the featured image flow.\n\t *\n\t * @return {void}\n\t */\n\tbuildAndSetFeatureImageFrame() {\n\t\tconst { wp } = window;\n\t\tconst { value: featuredImageId, multiple, allowedTypes } = this.props;\n\t\tconst featuredImageFrame = getFeaturedImageMediaFrame();\n\t\tconst attachments = getAttachmentsCollection( featuredImageId );\n\t\tconst selection = new wp.media.model.Selection( attachments.models, {\n\t\t\tprops: attachments.props.toJSON(),\n\t\t} );\n\t\tthis.frame = new featuredImageFrame( {\n\t\t\tmimeType: allowedTypes,\n\t\t\tstate: 'featured-image',\n\t\t\tmultiple,\n\t\t\tselection,\n\t\t\tediting: featuredImageId,\n\t\t} );\n\t\twp.media.frame = this.frame;\n\t\t// In order to select the current featured image when opening\n\t\t// the media library we have to set the appropriate settings.\n\t\t// Currently they are set in php for the post editor, but\n\t\t// not for site editor.\n\t\twp.media.view.settings.post = {\n\t\t\t...wp.media.view.settings.post,\n\t\t\tfeaturedImageId: featuredImageId || -1,\n\t\t};\n\t}\n\n\tcomponentWillUnmount() {\n\t\tthis.frame?.remove();\n\t}\n\n\tonUpdate( selections ) {\n\t\tconst { onSelect, multiple = false } = this.props;\n\t\tconst state = this.frame.state();\n\t\tconst selectedImages = selections || state.get( 'selection' );\n\n\t\tif ( ! selectedImages || ! selectedImages.models.length ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( multiple ) {\n\t\t\tonSelect(\n\t\t\t\tselectedImages.models.map( ( model ) =>\n\t\t\t\t\tslimImageObject( model.toJSON() )\n\t\t\t\t)\n\t\t\t);\n\t\t} else {\n\t\t\tonSelect( slimImageObject( selectedImages.models[ 0 ].toJSON() ) );\n\t\t}\n\t}\n\n\tonSelect() {\n\t\tconst { onSelect, multiple = false } = this.props;\n\t\t// Get media attachment details from the frame state.\n\t\tconst attachment = this.frame.state().get( 'selection' ).toJSON();\n\t\tonSelect( multiple ? attachment : attachment[ 0 ] );\n\t}\n\n\tonOpen() {\n\t\tconst { wp } = window;\n\t\tconst { value } = this.props;\n\t\tthis.updateCollection();\n\n\t\t//Handle active tab in media model on model open.\n\t\tif ( this.props.mode ) {\n\t\t\tthis.frame.content.mode( this.props.mode );\n\t\t}\n\n\t\t// Handle both this.props.value being either (number[]) multiple ids\n\t\t// (for galleries) or a (number) singular id (e.g. image block).\n\t\tconst hasMedia = Array.isArray( value ) ? !! value?.length : !! value;\n\n\t\tif ( ! hasMedia ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst isGallery = this.props.gallery;\n\t\tconst selection = this.frame.state().get( 'selection' );\n\t\tconst valueArray = Array.isArray( value ) ? value : [ value ];\n\n\t\tif ( ! isGallery ) {\n\t\t\tvalueArray.forEach( ( id ) => {\n\t\t\t\tselection.add( wp.media.attachment( id ) );\n\t\t\t} );\n\t\t}\n\n\t\t// Load the images so they are available in the media modal.\n\t\tconst attachments = getAttachmentsCollection( valueArray );\n\n\t\t// Once attachments are loaded, set the current selection.\n\t\tattachments.more().done( function () {\n\t\t\tif ( isGallery && attachments?.models?.length ) {\n\t\t\t\tselection.add( attachments.models );\n\t\t\t}\n\t\t} );\n\t}\n\n\tonClose() {\n\t\tconst { onClose } = this.props;\n\n\t\tif ( onClose ) {\n\t\t\tonClose();\n\t\t}\n\n\t\tthis.frame.detach();\n\t}\n\n\tupdateCollection() {\n\t\tconst frameContent = this.frame.content.get();\n\t\tif ( frameContent && frameContent.collection ) {\n\t\t\tconst collection = frameContent.collection;\n\n\t\t\t// Clean all attachments we have in memory.\n\t\t\tcollection\n\t\t\t\t.toArray()\n\t\t\t\t.forEach( ( model ) => model.trigger( 'destroy', model ) );\n\n\t\t\t// Reset has more flag, if library had small amount of items all items may have been loaded before.\n\t\t\tcollection.mirroring._hasMore = true;\n\n\t\t\t// Request items.\n\t\t\tcollection.more();\n\t\t}\n\t}\n\n\topenModal() {\n\t\tconst {\n\t\t\tallowedTypes,\n\t\t\tgallery = false,\n\t\t\tunstableFeaturedImageFlow = false,\n\t\t\tmodalClass,\n\t\t\tmultiple = false,\n\t\t\ttitle = __( 'Select or Upload Media' ),\n\t\t} = this.props;\n\t\tconst { wp } = window;\n\n\t\tif ( gallery ) {\n\t\t\tthis.buildAndSetGalleryFrame();\n\t\t} else {\n\t\t\tconst frameConfig = {\n\t\t\t\ttitle,\n\t\t\t\tmultiple,\n\t\t\t};\n\t\t\tif ( !! allowedTypes ) {\n\t\t\t\tframeConfig.library = { type: allowedTypes };\n\t\t\t}\n\n\t\t\tthis.frame = wp.media( frameConfig );\n\t\t}\n\n\t\tif ( modalClass ) {\n\t\t\tthis.frame.$el.addClass( modalClass );\n\t\t}\n\n\t\tif ( unstableFeaturedImageFlow ) {\n\t\t\tthis.buildAndSetFeatureImageFrame();\n\t\t}\n\t\tthis.initializeListeners();\n\t\tthis.frame.open();\n\t}\n\n\trender() {\n\t\treturn this.props.render( { open: this.openModal } );\n\t}\n}\n\nexport default MediaUpload;\n","/**\n * Determines whether the passed argument appears to be a plain object.\n *\n * @param data The object to inspect.\n */\nfunction isPlainObject( data: unknown ): data is Record< string, unknown > {\n\treturn (\n\t\tdata !== null &&\n\t\ttypeof data === 'object' &&\n\t\tObject.getPrototypeOf( data ) === Object.prototype\n\t);\n}\n\n/**\n * Recursively flatten data passed to form data, to allow using multi-level objects.\n *\n * @param {FormData}      formData Form data object.\n * @param {string}        key      Key to amend to form data object\n * @param {string|Object} data     Data to be amended to form data.\n */\nexport function flattenFormData(\n\tformData: FormData,\n\tkey: string,\n\tdata: string | undefined | Record< string, string >\n) {\n\tif ( isPlainObject( data ) ) {\n\t\tfor ( const [ name, value ] of Object.entries( data ) ) {\n\t\t\tflattenFormData( formData, `${ key }[${ name }]`, value );\n\t\t}\n\t} else if ( data !== undefined ) {\n\t\tformData.append( key, String( data ) );\n\t}\n}\n","/**\n * Browsers may use unexpected mime types, and they differ from browser to browser.\n * This function computes a flexible array of mime types from the mime type structured provided by the server.\n * Converts { jpg|jpeg|jpe: \"image/jpeg\" } into [ \"image/jpeg\", \"image/jpg\", \"image/jpeg\", \"image/jpe\" ]\n *\n * @param {?Object} wpMimeTypesObject Mime type object received from the server.\n *                                    Extensions are keys separated by '|' and values are mime types associated with an extension.\n *\n * @return An array of mime types or null\n */\nexport function getMimeTypesArray(\n\twpMimeTypesObject?: Record< string, string > | null\n) {\n\tif ( ! wpMimeTypesObject ) {\n\t\treturn null;\n\t}\n\treturn Object.entries( wpMimeTypesObject ).flatMap(\n\t\t( [ extensionsString, mime ] ) => {\n\t\t\tconst [ type ] = mime.split( '/' );\n\t\t\tconst extensions = extensionsString.split( '|' );\n\t\t\treturn [\n\t\t\t\tmime,\n\t\t\t\t...extensions.map(\n\t\t\t\t\t( extension ) => `${ type }/${ extension }`\n\t\t\t\t),\n\t\t\t];\n\t\t}\n\t);\n}\n","/**\n * Internal dependencies\n */\nimport type { Attachment, RestAttachment } from './types';\n\n/**\n * Transforms an attachment object from the REST API shape into the shape expected by the block editor and other consumers.\n *\n * @param attachment REST API attachment object.\n */\nexport function transformAttachment( attachment: RestAttachment ): Attachment {\n\t// eslint-disable-next-line camelcase\n\tconst { alt_text, source_url, ...savedMediaProps } = attachment;\n\treturn {\n\t\t...savedMediaProps,\n\t\talt: attachment.alt_text,\n\t\tcaption: attachment.caption?.raw ?? '',\n\t\ttitle: attachment.title.raw,\n\t\turl: attachment.source_url,\n\t\tposter:\n\t\t\tattachment._embedded?.[ 'wp:featuredmedia' ]?.[ 0 ]?.source_url ||\n\t\t\tundefined,\n\t};\n}\n","interface UploadErrorArgs {\n\tcode: string;\n\tmessage: string;\n\tfile: File;\n\tcause?: Error;\n}\n\n/**\n * MediaError class.\n *\n * Small wrapper around the `Error` class\n * to hold an error code and a reference to a file object.\n */\nexport class UploadError extends Error {\n\tcode: string;\n\tfile: File;\n\n\tconstructor( { code, message, file, cause }: UploadErrorArgs ) {\n\t\tsuper( message, { cause } );\n\n\t\tObject.setPrototypeOf( this, new.target.prototype );\n\n\t\tthis.code = code;\n\t\tthis.file = file;\n\t}\n}\n","/**\n * WordPress dependencies\n */\nimport { __, sprintf } from '@wordpress/i18n';\nimport { createBlobURL, revokeBlobURL } from '@wordpress/blob';\n\n/**\n * Internal dependencies\n */\nimport type {\n\tAdditionalData,\n\tAttachment,\n\tOnChangeHandler,\n\tOnErrorHandler,\n\tOnSuccessHandler,\n} from './types';\nimport { uploadToServer } from './upload-to-server';\nimport { validateMimeType } from './validate-mime-type';\nimport { validateMimeTypeForUser } from './validate-mime-type-for-user';\nimport { validateFileSize } from './validate-file-size';\nimport { UploadError } from './upload-error';\n\ninterface UploadMediaArgs {\n\t// Additional data to include in the request.\n\tadditionalData?: AdditionalData;\n\t// Array with the types of media that can be uploaded, if unset all types are allowed.\n\tallowedTypes?: string[];\n\t// List of files.\n\tfilesList: File[];\n\t// Maximum upload size in bytes allowed for the site.\n\tmaxUploadFileSize?: number;\n\t// Function called when an error happens.\n\tonError?: OnErrorHandler;\n\t// Function called each time a file or a temporary representation of the file is available.\n\tonFileChange?: OnChangeHandler;\n\t// Function called once a file has completely finished uploading, including thumbnails.\n\tonSuccess?: OnSuccessHandler;\n\t// List of allowed mime types and file extensions.\n\twpAllowedMimeTypes?: Record< string, string > | null;\n\t// Abort signal.\n\tsignal?: AbortSignal;\n}\n\n/**\n * Upload a media file when the file upload button is activated\n * or when adding a file to the editor via drag & drop.\n *\n * @param $0                    Parameters object passed to the function.\n * @param $0.allowedTypes       Array with the types of media that can be uploaded, if unset all types are allowed.\n * @param $0.additionalData     Additional data to include in the request.\n * @param $0.filesList          List of files.\n * @param $0.maxUploadFileSize  Maximum upload size in bytes allowed for the site.\n * @param $0.onError            Function called when an error happens.\n * @param $0.onFileChange       Function called each time a file or a temporary representation of the file is available.\n * @param $0.wpAllowedMimeTypes List of allowed mime types and file extensions.\n * @param $0.signal             Abort signal.\n */\nexport function uploadMedia( {\n\twpAllowedMimeTypes,\n\tallowedTypes,\n\tadditionalData = {},\n\tfilesList,\n\tmaxUploadFileSize,\n\tonError,\n\tonFileChange,\n\tsignal,\n}: UploadMediaArgs ) {\n\tconst validFiles = [];\n\n\tconst filesSet: Array< Partial< Attachment > | null > = [];\n\tconst setAndUpdateFiles = ( index: number, value: Attachment | null ) => {\n\t\tif ( filesSet[ index ]?.url ) {\n\t\t\trevokeBlobURL( filesSet[ index ].url );\n\t\t}\n\t\tfilesSet[ index ] = value;\n\t\tonFileChange?.(\n\t\t\tfilesSet.filter( ( attachment ) => attachment !== null )\n\t\t);\n\t};\n\n\tfor ( const mediaFile of filesList ) {\n\t\t// Verify if user is allowed to upload this mime type.\n\t\t// Defer to the server when type not detected.\n\t\ttry {\n\t\t\tvalidateMimeTypeForUser( mediaFile, wpAllowedMimeTypes );\n\t\t} catch ( error: unknown ) {\n\t\t\tonError?.( error as Error );\n\t\t\tcontinue;\n\t\t}\n\n\t\t// Check if the caller (e.g. a block) supports this mime type.\n\t\t// Defer to the server when type not detected.\n\t\ttry {\n\t\t\tvalidateMimeType( mediaFile, allowedTypes );\n\t\t} catch ( error: unknown ) {\n\t\t\tonError?.( error as Error );\n\t\t\tcontinue;\n\t\t}\n\n\t\t// Verify if file is greater than the maximum file upload size allowed for the site.\n\t\ttry {\n\t\t\tvalidateFileSize( mediaFile, maxUploadFileSize );\n\t\t} catch ( error: unknown ) {\n\t\t\tonError?.( error as Error );\n\t\t\tcontinue;\n\t\t}\n\n\t\tvalidFiles.push( mediaFile );\n\n\t\t// Set temporary URL to create placeholder media file, this is replaced\n\t\t// with final file from media gallery when upload is `done` below.\n\t\tfilesSet.push( { url: createBlobURL( mediaFile ) } );\n\t\tonFileChange?.( filesSet as Array< Partial< Attachment > > );\n\t}\n\n\tvalidFiles.map( async ( file, index ) => {\n\t\ttry {\n\t\t\tconst attachment = await uploadToServer(\n\t\t\t\tfile,\n\t\t\t\tadditionalData,\n\t\t\t\tsignal\n\t\t\t);\n\t\t\tsetAndUpdateFiles( index, attachment );\n\t\t} catch ( error ) {\n\t\t\t// Reset to empty on failure.\n\t\t\tsetAndUpdateFiles( index, null );\n\n\t\t\tlet message;\n\t\t\tif ( error instanceof Error ) {\n\t\t\t\tmessage = error.message;\n\t\t\t} else {\n\t\t\t\tmessage = sprintf(\n\t\t\t\t\t// translators: %s: file name\n\t\t\t\t\t__( 'Error while uploading file %s to the media library.' ),\n\t\t\t\t\tfile.name\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tonError?.(\n\t\t\t\tnew UploadError( {\n\t\t\t\t\tcode: 'GENERAL',\n\t\t\t\t\tmessage,\n\t\t\t\t\tfile,\n\t\t\t\t\tcause: error instanceof Error ? error : undefined,\n\t\t\t\t} )\n\t\t\t);\n\t\t}\n\t} );\n}\n","/**\n * WordPress dependencies\n */\nimport apiFetch from '@wordpress/api-fetch';\n\n/**\n * Internal dependencies\n */\nimport { flattenFormData } from './flatten-form-data';\nimport { transformAttachment } from './transform-attachment';\nimport type { CreateRestAttachment, RestAttachment } from './types';\n\nexport async function uploadToServer(\n\tfile: File,\n\tadditionalData: CreateRestAttachment = {},\n\tsignal?: AbortSignal\n) {\n\t// Create upload payload.\n\tconst data = new FormData();\n\tdata.append( 'file', file, file.name || file.type.replace( '/', '.' ) );\n\tfor ( const [ key, value ] of Object.entries( additionalData ) ) {\n\t\tflattenFormData(\n\t\t\tdata,\n\t\t\tkey,\n\t\t\tvalue as string | Record< string, string > | undefined\n\t\t);\n\t}\n\n\treturn transformAttachment(\n\t\tawait apiFetch< RestAttachment >( {\n\t\t\t// This allows the video block to directly get a video's poster image.\n\t\t\tpath: '/wp/v2/media?_embed=wp:featuredmedia',\n\t\t\tbody: data,\n\t\t\tmethod: 'POST',\n\t\t\tsignal,\n\t\t} )\n\t);\n}\n","/**\n * WordPress dependencies\n */\nimport { __, sprintf } from '@wordpress/i18n';\n\n/**\n * Internal dependencies\n */\nimport { UploadError } from './upload-error';\n\n/**\n * Verifies whether the file is within the file upload size limits for the site.\n *\n * @param file              File object.\n * @param maxUploadFileSize Maximum upload size in bytes allowed for the site.\n */\nexport function validateFileSize( file: File, maxUploadFileSize?: number ) {\n\t// Don't allow empty files to be uploaded.\n\tif ( file.size <= 0 ) {\n\t\tthrow new UploadError( {\n\t\t\tcode: 'EMPTY_FILE',\n\t\t\tmessage: sprintf(\n\t\t\t\t// translators: %s: file name.\n\t\t\t\t__( '%s: This file is empty.' ),\n\t\t\t\tfile.name\n\t\t\t),\n\t\t\tfile,\n\t\t} );\n\t}\n\n\tif ( maxUploadFileSize && file.size > maxUploadFileSize ) {\n\t\tthrow new UploadError( {\n\t\t\tcode: 'SIZE_ABOVE_LIMIT',\n\t\t\tmessage: sprintf(\n\t\t\t\t// translators: %s: file name.\n\t\t\t\t__(\n\t\t\t\t\t'%s: This file exceeds the maximum upload size for this site.'\n\t\t\t\t),\n\t\t\t\tfile.name\n\t\t\t),\n\t\t\tfile,\n\t\t} );\n\t}\n}\n","/**\n * WordPress dependencies\n */\nimport { __, sprintf } from '@wordpress/i18n';\n\n/**\n * Internal dependencies\n */\nimport { UploadError } from './upload-error';\nimport { getMimeTypesArray } from './get-mime-types-array';\n\n/**\n * Verifies if the user is allowed to upload this mime type.\n *\n * @param file               File object.\n * @param wpAllowedMimeTypes List of allowed mime types and file extensions.\n */\nexport function validateMimeTypeForUser(\n\tfile: File,\n\twpAllowedMimeTypes?: Record< string, string > | null\n) {\n\t// Allowed types for the current WP_User.\n\tconst allowedMimeTypesForUser = getMimeTypesArray( wpAllowedMimeTypes );\n\n\tif ( ! allowedMimeTypesForUser ) {\n\t\treturn;\n\t}\n\n\tconst isAllowedMimeTypeForUser = allowedMimeTypesForUser.includes(\n\t\tfile.type\n\t);\n\n\tif ( file.type && ! isAllowedMimeTypeForUser ) {\n\t\tthrow new UploadError( {\n\t\t\tcode: 'MIME_TYPE_NOT_ALLOWED_FOR_USER',\n\t\t\tmessage: sprintf(\n\t\t\t\t// translators: %s: file name.\n\t\t\t\t__(\n\t\t\t\t\t'%s: Sorry, you are not allowed to upload this file type.'\n\t\t\t\t),\n\t\t\t\tfile.name\n\t\t\t),\n\t\t\tfile,\n\t\t} );\n\t}\n}\n","/**\n * WordPress dependencies\n */\nimport { __, sprintf } from '@wordpress/i18n';\n\n/**\n * Internal dependencies\n */\nimport { UploadError } from './upload-error';\n\n/**\n * Verifies if the caller (e.g. a block) supports this mime type.\n *\n * @param file         File object.\n * @param allowedTypes List of allowed mime types.\n */\nexport function validateMimeType( file: File, allowedTypes?: string[] ) {\n\tif ( ! allowedTypes ) {\n\t\treturn;\n\t}\n\n\t// Allowed type specified by consumer.\n\tconst isAllowedType = allowedTypes.some( ( allowedType ) => {\n\t\t// If a complete mimetype is specified verify if it matches exactly the mime type of the file.\n\t\tif ( allowedType.includes( '/' ) ) {\n\t\t\treturn allowedType === file.type;\n\t\t}\n\t\t// Otherwise a general mime type is used, and we should verify if the file mimetype starts with it.\n\t\treturn file.type.startsWith( `${ allowedType }/` );\n\t} );\n\n\tif ( file.type && ! isAllowedType ) {\n\t\tthrow new UploadError( {\n\t\t\tcode: 'MIME_TYPE_NOT_SUPPORTED',\n\t\t\tmessage: sprintf(\n\t\t\t\t// translators: %s: file name.\n\t\t\t\t__( '%s: Sorry, this file type is not supported here.' ),\n\t\t\t\tfile.name\n\t\t\t),\n\t\t\tfile,\n\t\t} );\n\t}\n}\n","module.exports = window[\"wp\"][\"apiFetch\"];","module.exports = window[\"wp\"][\"blob\"];","module.exports = window[\"wp\"][\"element\"];","module.exports = window[\"wp\"][\"i18n\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","export * from './components';\n\nexport { uploadMedia } from './utils/upload-media';\nexport { transformAttachment } from './utils/transform-attachment';\nexport { validateFileSize } from './utils/validate-file-size';\nexport { validateMimeType } from './utils/validate-mime-type';\nexport { validateMimeTypeForUser } from './utils/validate-mime-type-for-user';\n\nexport type { Attachment, RestAttachment } from './utils/types';\n"],"names":["default","MediaUpload","Component","__","DEFAULT_EMPTY_GALLERY","getFeaturedImageMediaFrame","wp","window","media","view","MediaFrame","Select","extend","featuredImageToolbar","toolbar","createSelectToolbar","text","l10n","setFeaturedImage","state","options","editState","selection","get","EditImage","model","single","controller","render","content","set","loadEditor","createStates","on","states","add","FeaturedImage","editImage","getGalleryDetailsMediaFrame","Post","galleryToolbar","editing","Toolbar","items","insert","style","updateGallery","insertGallery","priority","requires","library","click","close","trigger","setState","reset","Library","id","title","createGalleryTitle","filterable","multiple","editable","query","type","GalleryEdit","menu","displaySettings","GalleryAdd","slimImageObject","img","attrSet","reduce","result","key","hasOwnProperty","getAttachmentsCollection","ids","order","orderby","post__in","posts_per_page","constructor","arguments","openModal","bind","onOpen","onSelect","onUpdate","onClose","initializeListeners","frame","buildAndSetGalleryFrame","addToGallery","allowedTypes","value","props","lastGalleryValue","remove","currentState","length","GalleryDetailsMediaFrame","attachments","Selection","models","toJSON","mimeType","buildAndSetFeatureImageFrame","featuredImageId","featuredImageFrame","settings","post","componentWillUnmount","selections","selectedImages","map","attachment","updateCollection","mode","hasMedia","Array","isArray","isGallery","gallery","valueArray","forEach","more","done","detach","frameContent","collection","toArray","mirroring","_hasMore","unstableFeaturedImageFlow","modalClass","frameConfig","$el","addClass","open","isPlainObject","data","Object","getPrototypeOf","prototype","flattenFormData","formData","name","entries","undefined","append","String","getMimeTypesArray","wpMimeTypesObject","flatMap","extensionsString","mime","split","extensions","extension","transformAttachment","_attachment$caption$r","alt_text","source_url","savedMediaProps","alt","caption","raw","url","poster","_embedded","UploadError","Error","code","message","file","cause","setPrototypeOf","new","target","sprintf","createBlobURL","revokeBlobURL","uploadToServer","validateMimeType","validateMimeTypeForUser","validateFileSize","uploadMedia","wpAllowedMimeTypes","additionalData","filesList","maxUploadFileSize","onError","onFileChange","signal","validFiles","filesSet","setAndUpdateFiles","index","filter","mediaFile","error","push","apiFetch","FormData","replace","path","body","method","size","allowedMimeTypesForUser","isAllowedMimeTypeForUser","includes","isAllowedType","some","allowedType","startsWith"],"sourceRoot":""}